---
title: 异步
comment: false
editLink: false
prev: false
next: false
---

## 简介

[异步延续(Asynchronous Continuations)](https://docs.camunda.org/manual/7.14/user-guide/process-engine/transactions-in-processes/?__hstc=218867270.b253ba482f458f28fb9913844d286075.1728126657448.1728126657448.1728126657448.1&__hssc=218867270.1.1728126657448&__hsfp=3729155053&_gl=1*nc2b5o*_ga*MzU1MTg2NDE4LjE3MjgxMjY2NTk.*_ga_4EYN8X5FNR*MTcyODEyNjY1OS4xLjAuMTcyODEyNjY1OS4wLjAuMTU4ODc0NDgxMw..*FPAU*MTc5ODUxMTI1OC4xNzI4MTI2NTgy#asynchronous-continuations)用于处理异步任务

## 配置异步任务

首先启用异步任务执行器

```kotlin
val camundaEngine = camunda {
    ... //其它配置
    isJobExecutorActivate = true
}
```

![](https://github.com/cruldra/picx-images-hosting/raw/master/image.5xam32n1tj.webp)

1. Before(之前): 当选中时,表示在执行此元素(在这个案例中是开始事件)之前,会创建一个异步作业.这意味着流程实例会立即创建,但实际的执行会被推迟到后台的作业执行器处理.
2. After(之后):如果选中,会在元素执行完成后创建一个异步作业.这意味着元素会立即执行,但后续的流程步骤会被推迟到异步作业中进行.
3. Exclusive(排他):当选中时,确保相关的异步继续(无论是Before还是After)会被排他地执行.这意味着在同一时间只有一个与此流程实例相关的作业会被执行,防止并发问题.

````kotlin
class TestDelegate : JavaDelegate {
    override fun execute(execution: DelegateExecution?) {
        println("${Thread.currentThread().name} TestDelegate 开始执行")
        Thread.sleep(5000)  // 模拟长时间运行的任务
        println("${Thread.currentThread().name} TestDelegate 执行完成")
    }

}


camundaEngine.deployClassPathFlow("flows/sample-process.bpmn")
val id = camundaEngine.runProcess("TestProcess").id
val id2 = camundaEngine.runProcess("TestProcess").id

````
