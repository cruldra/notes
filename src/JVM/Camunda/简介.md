---
title: 简介
comment: false
editLink: false
prev: false
next: false
order: 1
---
## 简介

[Camunda](https://docs.camunda.org/manual/7.21/)是一个开源的`BPMN`流程引擎.

## 核心概念

### 网关(Gateway)

网关用于控制流程的流向,主要有以下几种类型:

1. 排他网关(Exclusive Gateway): 基于条件选择一条路径.
2. 并行网关(Parallel Gateway): 同时激活多条路径.
3. 事件基础网关(Event-based Gateway): 基于事件选择路径.

### 任务(Task)

任务代表流程中需要完成的工作单元,主要类型包括:

1. 用户任务(User Task): 需要人工完成的任务.
2. 服务任务(Service Task): 自动执行的任务,通常是调用外部服务或执行脚本.
3. 脚本任务(Script Task): 执行一段脚本代码.
4. 业务规则任务(Business Rule Task): 执行业务规则的任务.

### 子流程(SubProcess)

### 事件(Event)

### 数据(Data)

### 参与者(Participant)


## 安装

```xml
<dependency>
    <groupId>org.camunda.bpm</groupId>
    <artifactId>camunda-engine</artifactId>
    <version>7.21.0</version>
</dependency>


<dependency>
    <groupId>com.h2database</groupId>
    <artifactId>h2</artifactId>
    <version>2.2.224</version>
</dependency>
```

## 使用

1. 初始化流程引擎

```kotlin
val config: ProcessEngineConfiguration = StandaloneProcessEngineConfiguration()
    .setDatabaseSchemaUpdate(ProcessEngineConfiguration.DB_SCHEMA_UPDATE_TRUE)
    .setJdbcUrl("jdbc:h2:file:./szr-api;TRACE_LEVEL_FILE=0")
    .setJdbcDriver("org.h2.Driver")

processEngine = config.buildProcessEngine()
```

2. 部署流程到引擎中

```kotlin
val repositoryService = processEngine.repositoryService
val deployment = repositoryService.createDeployment()
    .addClasspathResource("flows/sample-process.bpmn")
    .deploy()
println("Deployment created: " + deployment.id)
```

3. 启动流程

```kotlin
val runtimeService = processEngine.runtimeService
val processInstance = runtimeService.startProcessInstanceByKey("PrintMessageProcess")
println("Process instance started: " + processInstance.id)
```

4. 查询任务

```kotlin
val taskService = processEngine.taskService
val tasks = taskService.createTaskQuery().list()
println("Number of tasks: " + tasks.size)
for (task in tasks) {
    println("Task: " + task.name)
}
```

## 表结构

`camunda`在数据库中存储流程、任务相关的信息,这些表的结构[参考](https://poe.com/s/ROHz7FaTjaiu9p69pYwR)
