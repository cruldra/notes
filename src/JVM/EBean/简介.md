---
title: 简介
comment: false
editLink: false
prev: false
next: false
order: 1
---


## 简介

## 安装

### 1. 添加`jdbc`驱动

::: code-tabs#sqlite

@tab:active sqlite
```xml
 <dependency>
    <groupId>org.xerial</groupId>
    <artifactId>sqlite-jdbc</artifactId>
    <version>3.46.1.3</version>
</dependency>
```

@tab h2

```xml
 <dependency>
    <groupId>com.h2database</groupId>
    <artifactId>h2</artifactId>
    <version>2.2.224</version>
</dependency>
```

:::



### 2. 添加对应的`EBean`依赖
::: code-tabs#sqlite

@tab:active sqlite

```xml
<dependency>
    <groupId>io.ebean</groupId>
    <artifactId>ebean-platform-sqlite</artifactId>
    <version>15.6.0</version>
</dependency>
```

@tab h2
```xml
<dependency>
    <groupId>io.ebean</groupId>
    <artifactId>ebean-platform-h2</artifactId>
    <version>15.6.0</version>
</dependency>
```
:::

如果使用`QueryBean`,还需要

```xml

<dependency>
    <groupId>io.ebean</groupId>
    <artifactId>ebean-querybean</artifactId>
    <version>15.6.0</version>
</dependency>
```

### 3. 安装`maven`插件

```xml
<plugin>
    <groupId>io.ebean</groupId>
    <artifactId>ebean-maven-plugin</artifactId>
    <version>15.6.0</version>
    <extensions>true</extensions>
</plugin>
```

### 4. 配置`apt`插件用于生成`QueryBean`

```xml
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>3.13.0</version>
    <configuration>
        <annotationProcessorPaths>
            <path> <!-- generate ebean query beans -->
                <groupId>io.ebean</groupId>
                <artifactId>querybean-generator</artifactId>
                <version>15.6.0</version>
            </path>
        </annotationProcessorPaths>
    </configuration>
</plugin>
```

:::tip
上面这种方式需要使用`java`来定义实体类,如果想使用`kotlin`来定义实体类,则需要在`kotlin-maven-plugin`插件配置中添加`kapt`配置
:::

```xml
<plugin>
    <groupId>org.jetbrains.kotlin</groupId>
    <artifactId>kotlin-maven-plugin</artifactId>
    <version>2.0.10</version>
    <executions>
        ...
        <execution>
            <id>kapt</id>
            <goals>
                <goal>kapt</goal>
            </goals>
            <configuration>
                <sourceDirs>
                    <sourceDir>src/main/kotlin</sourceDir>
                </sourceDirs>
                <annotationProcessorPaths>
                    <annotationProcessorPath>
                        <groupId>io.ebean</groupId>
                        <artifactId>kotlin-querybean-generator</artifactId>
                        <version>15.6.0</version>
                    </annotationProcessorPath>
                </annotationProcessorPaths>
            </configuration>
        </execution>
    </executions>
</plugin>

```

### 5. 创建数据库

```kotlin
val dataSourceConfig = DataSourceConfig()
dataSourceConfig.setUsername(dataSourceProperties.username)
dataSourceConfig.setPassword(dataSourceProperties.password)
dataSourceConfig.setUrl(dataSourceProperties.databaseUrl)
dataSourceConfig.setDriver(dataSourceProperties.databaseDriver)

val config = DatabaseConfig()
config.setDataSourceConfig(dataSourceConfig)

DatabaseFactory.create(config)
```

## 定义`EBean`实体类

```kotlin
@Entity
@Table(name = "table_name")
class Entity{

    /**
     * 普通字段
     */
    @Column(name = "name", length = 50)
    var name: String? = null

    /**
     * 多对一关系
     */
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "user_id")
    var user: HiUser? = null
    
    
    /**
     * 枚举类型
     */
    @Enumerated(EnumType.STRING)
    @Column(name = "type")
    var type: AccountType? = null
    
    /**
     * 一对多关系
     */
    @OrderBy("payTime DESC")
    @OneToMany(mappedBy = "account", fetch = FetchType.LAZY, cascade = [CascadeType.ALL])
    var orders: MutableList<HiOrder> = mutableListOf()

}
```

## 生成`QueryBean`

按照上面的安装步骤配置好以后运行`mvn compile`命令,就会在`target/generated-sources`目录下生成`QueryBean`,如图:

![](https://github.com/cruldra/picx-images-hosting/raw/master/image.361jmvvrqk.png)
