import{_ as s,o as i,c as a,e as n}from"./app-Bmelea3n.js";const t="/assets/%E6%94%AF%E4%BB%98%E5%AE%9Dpc%E7%BD%91%E7%AB%99%E6%94%AF%E4%BB%98-iQXCkYnB.svg",e={},l=n('<h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介"><span>简介</span></a></h2><p><code>pc</code>端网站应用接入支付宝支付的流程如下图所示:</p><figure><img src="'+t+`" alt="支付宝pc网站支付.svg" tabindex="0" loading="lazy"><figcaption>支付宝pc网站支付.svg</figcaption></figure><h2 id="准备工作" tabindex="-1"><a class="header-anchor" href="#准备工作"><span>准备工作</span></a></h2><p>要在<code>pc</code> 端网站上接入支付宝支付,需要先<a href="https://b.alipay.com/page/settle-b/guide" target="_blank" rel="noopener noreferrer">注册</a> 一个商户账号,然后<a href="https://open.alipay.com/develop/pm/create?templateId=6-bcb9-7250e6fd2c431487669730456&amp;from=payappsite" target="_blank" rel="noopener noreferrer">创建网页应用</a></p><p>应用创建好以后在<code>开发设置</code>中配置好<code>密钥</code>和<code>回调地址</code></p><figure><img src="https://cdn.jsdelivr.net/gh/hhypygy/images@master/20240112/image.72fq93ksfmo0.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="沙箱环境" tabindex="-1"><a class="header-anchor" href="#沙箱环境"><span>沙箱环境</span></a></h2><p>支付宝要求应用审核通过后才能正式使用,开发过程中我们可以使用<a href="https://open.alipay.com/develop/sandbox/app" target="_blank" rel="noopener noreferrer">沙箱环境</a> 来模拟支付宝的支付流程.</p><figure><img src="https://cdn.jsdelivr.net/gh/hhypygy/images@master/20240112/image.5h0rtmw2oko0.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="hint-container warning"><p class="hint-container-title">注意</p><p>使用沙箱环境需要配套对应的<a href="https://open.alipay.com/develop/sandbox/tool" target="_blank" rel="noopener noreferrer">客户端</a> ,不然用正式版的支付宝客户端扫沙箱环境下生成的二维码会出现<code>二维码已失效,请刷新重试</code></p></div><h2 id="对接" tabindex="-1"><a class="header-anchor" href="#对接"><span>对接</span></a></h2><p>准备好相关材料后就可以开始正式编写代码来对接了,对接之前先确认下所需要的参数:</p><ol><li><strong>支付网关</strong> - 一个<code>url</code>,也就是谁来处理你发起的支付请求</li><li><strong>APPID</strong> - 应用ID,不同的应用可能会有不同的支付流程,多个应用共用商户的相关资质</li><li><strong>应用私钥</strong> - 用于和<code>支付宝公钥</code>一起保证交易的安全</li><li><strong>支付宝公钥</strong> - 用于和<code>应用私钥</code>一起保证交易的安全</li></ol><p>接下来引入<code>alipay-sdk-java</code>依赖:</p><div class="language-gradle line-numbers-mode" data-highlighter="shiki" data-ext="gradle" data-title="gradle" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>implementation(&quot;com.alipay.sdk:alipay-sdk-java:4.38.183.ALL&quot;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="发起支付请求" tabindex="-1"><a class="header-anchor" href="#发起支付请求"><span>发起支付请求</span></a></h3><details class="hint-container details"><summary>发起支付请求到支付宝网关</summary><div class="language-kotlin line-numbers-mode" data-highlighter="shiki" data-ext="kotlin" data-title="kotlin" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> AlipayTests</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> val</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> object</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">Mapper </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ObjectMapperBuilder.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">build</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">    @Test</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> test</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> DefaultAlipayClient</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            &quot;https://openapi-sandbox.dl.alipaydev.com/gateway.do&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//网关地址,这里是沙箱环境提供的,正式环境需要更换</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            &quot;商户id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            &quot;应用私钥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            &quot;json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            &quot;utf-8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            &quot;支付宝公钥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            &quot;RSA2&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        );</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> request </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> AlipayTradePagePayRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> bizContent </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> mapOf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            &quot;out_trade_no&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> to UUID.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomUUID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            &quot;total_amount&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> to </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            &quot;subject&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> to </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;测试&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            &quot;product_code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> to </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;FAST_INSTANT_TRADE_PAY&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        request.bizContent </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> object</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">Mapper.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">writeValueAsString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(bizContent)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> response </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> client.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pageExecute</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(request)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(response.body)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="引导用户进入支付页面" tabindex="-1"><a class="header-anchor" href="#引导用户进入支付页面"><span>引导用户进入支付页面</span></a></h3><p>请求提交成功后,支付宝会返回一个包含自提交表单的<code>html</code>页面,我们需要将这个页面返回给用户,让用户跳转到这个页面进行支付.</p><details class="hint-container details"><summary>支付宝网关返回的页面示例</summary><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">form</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;punchout_form&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;"> method</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;post&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;">      action</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;https://openapi-sandbox.dl.alipaydev.com/gateway.do?charset=utf-8&amp;method=alipay.trade.page.pay&amp;sign=dWN5Vc%2B%2BoppYaXc6VI2KeDMJ0%2FgYZ%2FbP6vAFswnPu2cTV1AoM54yTZ8XoDxWpEXHRqWfKVXyIZ%2FreeNdINd6tx5e3t4zkRmCmufFM2Th5yOGfSyGUInj98lTGznv5Q85dpP%2BNblvNsjNA3CDfeuatO6IzD8YljdZH6tNaMSfLyYF4N4i3anMLqdEQ39GjGqHPCotH9uboQkWaTYfxU0%2Br%2FSj9K1uwDKVNEE03%2FhN1M5ODJf%2FsXvI9l%2FTNev2h8jaBMW%2FneKp380AxtV61AgDUp9EDaWRFumxPQfoWld0acr85Wgq3DoumDZCzZHNZuoVi66Ml7ZPOJxOfpQytWk6ww%3D%3D&amp;version=1.0&amp;app_id=9021000133696987&amp;sign_type=RSA2&amp;timestamp=2024-01-12+20%3A54%3A44&amp;alipay_sdk=alipay-sdk-java-4.38.183.ALL&amp;format=json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;hidden&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;biz_content&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;">           value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;{</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">out_trade_no</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ed885859-e660-46ff-a820-8c6501ee3d35</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total_amount</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">subject</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">测试</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">product_code</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">FAST_INSTANT_TRADE_PAY</span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&amp;quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;submit&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;立即支付&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;"> style</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;display:none&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">form</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">document</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">forms</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">submit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><p>在前端把上面返回的<code>html</code>页面渲染出来</p><div class="language-ts line-numbers-mode" data-highlighter="shiki" data-ext="ts" data-title="ts" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">subscriptionService</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pcWebPay</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">gateway</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    amount</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">price</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    subject</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">plan</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> paymentWindow</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> window</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">open</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;_blank&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">paymentWindow</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        paymentWindow</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">document</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">html</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!!</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">})</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="回调" tabindex="-1"><a class="header-anchor" href="#回调"><span>回调</span></a></h3><p>用户在支付宝支付页面完成支付后,支付宝会将支付结果通知给商户应用,商户应用需要对支付结果进行验证、入库及展示等操作.</p><div class="language-kotlin line-numbers-mode" data-highlighter="shiki" data-ext="kotlin" data-title="kotlin" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">AlipayTradePagePayRequest request </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> new </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">AlipayTradePagePayRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">request.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setNotifyUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(alipayConfig.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getNotifyUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">());  </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//支付成功由支付宝异步通知应用网关</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">request.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setReturnUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(alipayConfig.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">getReturnUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()); </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//支付成功后向用户展示支付结果的页面的地址</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>关于<code>notifyUrl</code>和<code>returnUrl</code>的区别可以参考<a href="https://opendocs.alipay.com/open/270/105902" target="_blank" rel="noopener noreferrer">支付宝官方文档</a> 和<a href="https://poe.com/chat/1xa79mxvm666ybiojri" target="_blank" rel="noopener noreferrer">poe-setNotifyUrl和setReturnUrl的区别</a></p><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考"><span>参考</span></a></h2><ul><li><a href="https://blog.51cto.com/loveddz/6150371" target="_blank" rel="noopener noreferrer">SpringBoot 集成支付宝的各种应用场景__ddz的技术博客_51CTO博客</a></li><li><a href="https://juejin.cn/post/7244498421283881021#heading-4" target="_blank" rel="noopener noreferrer">SpringBoot集成支付宝支付 - 少走弯路就看这篇 - 掘金</a></li></ul>`,29),h=[l];function p(k,r){return i(),a("div",null,h)}const g=s(e,[["render",p],["__file","pc端网站应用.html.vue"]]),o=JSON.parse('{"path":"/Best%20Practices/Payment/%E6%94%AF%E4%BB%98%E5%AE%9D/pc%E7%AB%AF%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8.html","title":"pc端网站应用","lang":"zh-CN","frontmatter":{"title":"pc端网站应用","comment":false,"editLink":false,"prev":false,"next":false,"description":"简介 pc端网站应用接入支付宝支付的流程如下图所示: 支付宝pc网站支付.svg支付宝pc网站支付.svg 准备工作 要在pc 端网站上接入支付宝支付,需要先注册 一个商户账号,然后创建网页应用 应用创建好以后在开发设置中配置好密钥和回调地址 沙箱环境 支付宝要求应用审核通过后才能正式使用,开发过程中我们可以使用沙箱环境 来模拟支付宝的支付流程. 注意...","head":[["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/Best%20Practices/Payment/%E6%94%AF%E4%BB%98%E5%AE%9D/pc%E7%AB%AF%E7%BD%91%E7%AB%99%E5%BA%94%E7%94%A8.html"}],["meta",{"property":"og:site_name","content":"一星的臭弟弟"}],["meta",{"property":"og:title","content":"pc端网站应用"}],["meta",{"property":"og:description","content":"简介 pc端网站应用接入支付宝支付的流程如下图所示: 支付宝pc网站支付.svg支付宝pc网站支付.svg 准备工作 要在pc 端网站上接入支付宝支付,需要先注册 一个商户账号,然后创建网页应用 应用创建好以后在开发设置中配置好密钥和回调地址 沙箱环境 支付宝要求应用审核通过后才能正式使用,开发过程中我们可以使用沙箱环境 来模拟支付宝的支付流程. 注意..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://cdn.jsdelivr.net/gh/hhypygy/images@master/20240112/image.72fq93ksfmo0.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-07-03T23:01:39.000Z"}],["meta",{"property":"article:author","content":"Cruldra"}],["meta",{"property":"article:modified_time","content":"2024-07-03T23:01:39.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"pc端网站应用\\",\\"image\\":[\\"https://cdn.jsdelivr.net/gh/hhypygy/images@master/20240112/image.72fq93ksfmo0.png\\",\\"https://cdn.jsdelivr.net/gh/hhypygy/images@master/20240112/image.5h0rtmw2oko0.png\\"],\\"dateModified\\":\\"2024-07-03T23:01:39.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Cruldra\\",\\"url\\":\\"https://mister-hope.com\\"}]}"]]},"headers":[{"level":2,"title":"简介","slug":"简介","link":"#简介","children":[]},{"level":2,"title":"准备工作","slug":"准备工作","link":"#准备工作","children":[]},{"level":2,"title":"沙箱环境","slug":"沙箱环境","link":"#沙箱环境","children":[]},{"level":2,"title":"对接","slug":"对接","link":"#对接","children":[{"level":3,"title":"发起支付请求","slug":"发起支付请求","link":"#发起支付请求","children":[]},{"level":3,"title":"引导用户进入支付页面","slug":"引导用户进入支付页面","link":"#引导用户进入支付页面","children":[]},{"level":3,"title":"回调","slug":"回调","link":"#回调","children":[]}]},{"level":2,"title":"参考","slug":"参考","link":"#参考","children":[]}],"git":{"createdTime":1720047699000,"updatedTime":1720047699000,"contributors":[{"name":"cruldra","email":"cruldra@gmail.com","commits":1}]},"readingTime":{"minutes":3.03,"words":910},"filePathRelative":"Best Practices/Payment/支付宝/pc端网站应用.md","localizedDate":"2024年7月3日","autoDesc":true}');export{g as comp,o as data};
